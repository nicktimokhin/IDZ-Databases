-- =====================================================
-- Скрипт с тестовыми данными для системы "Учёт продаж фармацевтических товаров"
-- =====================================================

-- =====================================================
-- 1. СПРАВОЧНИК СТРАН
-- =====================================================
INSERT INTO "Страны" ("КодОКСМ", "НаименованиеСтраны") VALUES
(643, 'Россия'),
(276, 'Германия'),
(840, 'США'),
(250, 'Франция'),
(392, 'Япония'),
(756, 'Швейцария'),
(124, 'Канада'),
(380, 'Италия'),
(826, 'Великобритания'),
(704, 'Вьетнам');

-- =====================================================
-- 2. ЛЕКАРСТВЕННЫЕ СРЕДСТВА
-- =====================================================
INSERT INTO "ЛекарственныеСредства" ("РегНомерЛС", "ТорговоеНаименование", "МНН", "ЛекарственнаяФорма", "Дозировка", "Производитель", "КодОКСМ", "КодОКПД2", "УсловияОтпуска") VALUES
('ЛП-000001', 'Парацетамол', 'Парацетамол', 'таблетки', '500 мг', 'Фармстандарт-Лексредства', 643, '21.20.11.110', 'без рецепта'),
('ЛП-000002', 'Аспирин Кардио', 'Ацетилсалициловая кислота', 'таблетки', '100 мг', 'Байер АГ', 276, '21.20.11.110', 'без рецепта'),
('ЛП-000003', 'Нурофен', 'Ибупрофен', 'таблетки', '200 мг', 'Рекитт Бенкизер', 826, '21.20.11.110', 'без рецепта'),
('ЛП-000004', 'Амоксиклав', 'Амоксициллин + Клавулановая кислота', 'таблетки', '875 мг + 125 мг', 'Лек д.д.', 392, '21.20.11.130', 'по рецепту'),
('ЛП-000005', 'Витамин D3', 'Колекальциферол', 'капсулы', '2000 МЕ', 'Солгар', 840, '21.20.22.110', 'без рецепта'),
('ЛП-000006', 'Лизиноприл', 'Лизиноприл', 'таблетки', '10 мг', 'Гедеон Рихтер', 348, '21.20.11.120', 'по рецепту'),
('ЛП-000007', 'Магний B6', 'Магния цитрат + Пиридоксин', 'таблетки', '200 мг + 50 мг', 'Эвалар', 643, '21.20.22.110', 'без рецепта'),
('ЛП-000008', 'Корвалол', 'Валерьяновая кислота + Фенобарбитал', 'капли', '3% + 2%', 'Фармстандарт-Лексредства', 643, '21.20.11.140', 'без рецепта'),
('ЛП-000009', 'Ципрофлоксацин', 'Ципрофлоксацин', 'таблетки', '500 мг', 'Вертекс', 643, '21.20.11.130', 'по рецепту'),
('ЛП-000010', 'Терафлю', 'Парацетамол + Фенилэфрин + Фенирамин', 'порошок', '325 мг + 10 мг + 20 мг', 'Новартис', 756, '21.20.11.110', 'без рецепта');

-- =====================================================
-- 3. ПОСТАВЩИКИ
-- =====================================================
INSERT INTO "Поставщики" ("ИНН", "КПП", "ПолноеНаименование", "СокращённоеНаименование", "Адрес", "Телефон", "Email", "ФИОКонтакта") VALUES
('1234567890', '123456001', 'Общество с ограниченной ответственностью "ФармПлюс"', 'ООО "ФармПлюс"', 'г. Москва, ул. Ленина, д. 15, оф. 101', '+7 (495) 123-45-67', 'info@pharmaplus.ru', 'Иванов Иван Иванович'),
('2345678901', '234567002', 'Акционерное общество "МедФарм"', 'АО "МедФарм"', 'г. Санкт-Петербург, пр. Невский, д. 28', '+7 (812) 234-56-78', 'sales@medpharm.ru', 'Петров Петр Петрович'),
('3456789012', '345678003', 'Общество с ограниченной ответственностью "ГлобалФарма"', 'ООО "ГлобалФарма"', 'г. Екатеринбург, ул. Ленина, д. 45', '+7 (343) 345-67-89', 'orders@globalpharma.ru', 'Сидоров Александр Александрович'),
('4567890123', '456789004', 'Общество с ограниченной ответственностью "РегионМед"', 'ООО "РегионМед"', 'г. Казань, ул. Баумана, д. 12', '+7 (843) 456-78-90', 'contact@regionmed.ru', 'Козлов Михаил Михайлович'),
('5678901234', '567890005', 'Акционерное общество "ИнтерФарм"', 'АО "ИнтерФарм"', 'г. Новосибирск, ул. Красный проспект, д. 67', '+7 (383) 567-89-01', 'info@interpharm.ru', 'Новиков Дмитрий Дмитриевич');

-- =====================================================
-- 4. ПАРТИИ ТОВАРОВ
-- =====================================================
INSERT INTO "Партии" ("РегНомерЛС", "ИНН", "КПП", "НомерСерии", "СрокГодности", "ДатаПоступления", "КоличествоВУпаковке", "КоличествоУпаковок", "ЦенаЗакупки", "ЦенаПродажи", "Остаток") VALUES
-- Парацетамол от ФармПлюс
('ЛП-000001', '1234567890', '123456001', 'P001A', '2026-12-15', '2025-01-15', 20, 100, 25.50, 45.00, 85),
('ЛП-000001', '1234567890', '123456001', 'P001B', '2026-11-20', '2025-02-10', 20, 50, 26.00, 46.00, 42),

-- Аспирин Кардио от МедФарм
('ЛП-000002', '2345678901', '234567002', 'A001A', '2027-03-10', '2025-01-20', 30, 75, 180.00, 320.00, 60),
('ЛП-000002', '2345678901',', 'A001 '234567002B', '2027-02-25', '2025-02-05', 30, 40, 185.00, 325.00, 35рофен от ГлобалФЛП-000003', '3456789012',),

-- Нуарма
(' '345678003A', '2026-10-15', '2025', 'N001-01-25', 10, 80, 120.00, 220.00, 70),
('ЛП-000003', '3456789012', '345678003', 'N001B', '2026-09-30', '2025-02-15', 10, 30, 125.00, 225.00, 25),

-- Амоксиклав от РегионМед
('ЛП-000004', '4567890123', '456789004', 'AM001A', '2026-08-20', '2025-01-30', 14, 60, 450.00, 780.00, 45),
('ЛП-000004', '4567890123', '456789004', 'AM001B', '2026-07-15', '2025-02-20', 14, 20, 460.00, 790.00, 18),

-- Витамин D3 от ИнтерФарм
('ЛП-000005', '5678901234', '567890005', 'D001A', '2026-12-31', '2025-02-01', 60, 40, 350.00, 620.00, 35),

-- Лизиноприл от ФармПлюс
('ЛП-000006', '1234567890', '123456001', 'L001A', '2027-01-15', '2025-02-05', 30, 50, 85.00, 150.00, 42),

-- Магний B6 от МедФарм
('ЛП-000007', '2345678901', '234567002', 'M001A', '2026-11-10', '2025-02-10', 50, 30, 280.00, 480.00, 25),

-- Корвалол от ГлобалФарма
('ЛП-000008', '3456789012', '345678003', 'K001A', '2026-10-25', '2025-02-15', 1, 100, 15.00, 28.00, 85),

-- Ципрофлоксацин от РегионМед
('ЛП-000009', '4567890123', '456789004', 'C001A', '2026-06-30', '2025-02-20', 10, 40, 120.00, 210.00, 32),

-- Терафлю от ИнтерФарм
('ЛП-000010', '5678901234', '567890005', 'T001A', '2026-05-15', '2025-02-25', 10, 60, 95.00, 165.00, 50);

-- =====================================================
-- 5. КЛИЕНТЫ
-- =====================================================
INSERT INTO "Клиенты" ("НомерКарты", "ФИО", "Телефон", "Email", "ДатаРегистрации") VALUES
('DISC001', 'Андреев Сергей Александрович', '+7 (903) 123-45-67', 'andreev@email.ru', '2024-01-15'),
('DISC002', 'Белова Елена Викторовна', '+7 (916) 234-56-78', 'belova@email.ru', '2024-02-20'),
('DISC003', 'Волков Дмитрий Сергеевич', '+7 (925) 345-67-89', 'volkov@email.ru', '2024-03-10'),
('DISC004', 'Григорьева Ольга Ивановна', '+7 (903) 456-78-90', 'grigoreva@email.ru', '2024-04-05'),
('DISC005', 'Дмитриев Алексей Петрович', '+7 (916) 567-89-01', 'dmitriev@email.ru', '2024-05-12'),
('DISC006', 'Егорова Мария Александровна', '+7 (925) 678-90-12', 'egorova@email.ru', '2024-06-18'),
('DISC007', 'Жуков Игорь Николаевич', '+7 (903) 789-01-23', 'zhukov@email.ru', '2024-07-22'),
('DISC008', 'Зайцева Татьяна Сергеевна', '+7 (916) 890-12-34', 'zaytseva@email.ru', '2024-08-30'),
('DISC009', 'Иванов Андрей Владимирович', '+7 (925) 901-23-45', 'ivanov@email.ru', '2024-09-14'),
('DISC010', 'Кузнецова Наталья Михайловна', '+7 (903) 012-34-56', 'kuznetsova@email.ru', '2024-10-08');

-- =====================================================
-- 6. ЧЕКИ
-- =====================================================
INSERT INTO "Чеки" ("ДатаВремя", "НомерКарты", "ИтоговаяСумма", "IDКлиента") VALUES
-- Чеки за январь 2025
('2025-01-15 10:30:00', 'DISC001', 135.00, 1),
('2025-01-15 14:20:00', NULL, 45.00, NULL),
('2025-01-16 09:15:00', 'DISC002', 220.00, 2),
('2025-01-16 16:45:00', NULL, 780.00, NULL),
('2025-01-17 11:30:00', 'DISC003', 475.00, 3),
('2025-01-17 15:10:00', NULL, 28.00, NULL),
('2025-01-18 12:00:00', 'DISC001', 290.00, 1),
('2025-01-18 17:30:00', 'DISC004', 165.00, 4),

-- Чеки за февраль 2025
('2025-02-01 10:00:00', NULL, 46.00, NULL),
('2025-02-01 13:25:00', 'DISC005', 620.00, 5),
('2025-02-02 09:40:00', 'DISC002', 325.00, 2),
('2025-02-02 16:15:00', NULL, 150.00, NULL),
('2025-02-03 11:20:00', 'DISC006', 480.00, 6),
('2025-02-03 14:50:00', 'DISC003', 225.00, 3),
('2025-02-04 10:35:00', NULL, 210.00, NULL),
('2025-02-04 15:45:00', 'DISC007', 165.00, 7),

-- Чеки за март 2025
('2025-03-01 09:10:00', 'DISC008', 320.00, 8),
('2025-03-01 12:30:00', NULL, 90.00, NULL),
('2025-03-02 10:55:00', 'DISC009', 620.00, 9),
('2025-03-02 16:20:00', 'DISC010', 480.00, 10),
('2025-03-03 11:40:00', NULL, 45.00, NULL),
('2025-03-03 14:15:00', 'DISC001', 275.00, 1),
('2025-03-04 09:25:00', 'DISC004', 325.00, 4),
('2025-03-04 17:10:00', NULL, 780.00, NULL);

-- =====================================================
-- 7. ПОЗИЦИИ ЧЕКОВ
-- =====================================================
INSERT INTO "ПозицииЧека" ("НомерЧека", "РегНомерЛС", "ИНН", "КПП", "НомерСерии", "КоличествоПродано") VALUES
-- Чек №1 (Парацетамол 3 упаковки)
(1, 'ЛП-000001', '1234567890', '123456001', 'P001A', 3),

-- Чек №2 (Парацетамол 1 упаковка)
(2, 'ЛП-000001', '1234567890', '123456001', 'P001A', 1),

-- Чек №3 (Нурофен 1 упаковка)
(3, 'ЛП-000003', '3456789012', '345678003', 'N001A', 1),

-- Чек №4 (Амоксиклав 1 упаковка)
(4, 'ЛП-000004', '4567890123', '456789004', 'AM001A', 1),

-- Чек №5 (Витамин D3 1 + Магний B6 1)
(5, 'ЛП-000005', '5678901234', '567890005', 'D001A', 1),
(5, 'ЛП-000007', '2345678901', '234567002', 'M001A', 1),

-- Чек №6 (Корвалол 1 упаковка)
(6, 'ЛП-000008', '3456789012', '345678003', 'K001A', 1),

-- Чек №7 (Аспирин Кардио 1 + Витамин D3 1)
(7, 'ЛП-000002', '2345678901', '234567002', 'A001A', 1),
(7, 'ЛП-000005', '5678901234', '567890005', 'D001A', 1),

-- Чек №8 (Терафлю 1 упаковка)
(8, 'ЛП-000010', '5678901234', '567890005', 'T001A', 1),

-- Чек №9 (Парацетамол 1 упаковка)
(9, 'ЛП-000001', '1234567890', '123456001', 'P001B', 1),

-- Чек №10 (Витамин D3 1 упаковка)
(10, 'ЛП-000005', '5678901234', '567890005', 'D001A', 1),

-- Чек №11 (Аспирин Кардио 1 упаковка)
(11, 'ЛП-000002', '2345678901', '234567002', 'A001A', 1),

-- Чек №12 (Лизиноприл 1 упаковка)
(12, 'ЛП-000006', '1234567890', '123456001', 'L001A', 1),

-- Чек №13 (Магний B6 1 упаковка)
(13, 'ЛП-000007', '2345678901', '234567002', 'M001A', 1),

-- Чек №14 (Нурофен 1 упаковка)
(14, 'ЛП-000003', '3456789012', '345678003', 'N001B', 1),

-- Чек №15 (Ципрофлоксацин 1 упаковка)
(15, 'ЛП-000009', '4567890123', '456789004', 'C001A', 1),

-- Чек №16 (Терафлю 1 упаковка)
(16, 'ЛП-000010', '5678901234', '567890005', 'T001A', 1),

-- Чек №17 (Аспирин Кардио 1 упаковка)
(17, 'ЛП-000002', '2345678901', '234567002', 'A001B', 1),

-- Чек №18 (Парацетамол 2 упаковки)
(18, 'ЛП-000001', '1234567890', '123456001', 'P001B', 2),

-- Чек №19 (Аспирин Кардио 1 + Корвалол 1)
(19, 'ЛП-000002', '2345678901', '234567002', 'A001B', 1),
(19, 'ЛП-000008', '3456789012', '345678003', 'K001A', 1),

-- Чек №20 (Магний B6 1 + Витамин D3 1)
(20, 'ЛП-000007', '2345678901', '234567002', 'M001A', 1),
(20, 'ЛП-000005', '5678901234', '567890005', 'D001A', 1),

-- Чек №21 (Парацетамол 1 упаковка)
(21, 'ЛП-000001', '1234567890', '123456001', 'P001A', 1),

-- Чек №22 (Аспирин Кардио 1 упаковка)
(22, 'ЛП-000002', '2345678901', '234567002', 'A001A', 1),

-- Чек №23 (Магний B6 1 упаковка)
(23, 'ЛП-000007', '2345678901', '234567002', 'M001A', 1),

-- Чек №24 (Амоксиклав 1 упаковка)
(24, 'ЛП-000004', '4567890123', '456789004', 'AM001A', 1),

-- Дополнительные продажи для демонстрации аналитики
(25, 'ЛП-000001', '1234567890', '123456001', 'P001A', 2),
(26, 'ЛП-000003', '3456789012', '345678003', 'N001A', 1),
(27, 'ЛП-000005', '5678901234', '567890005', 'D001A', 2),
(28, 'ЛП-000007', '2345678901', '234567002', 'M001A', 1),
(29, 'ЛП-000002', '2345678901', '234567002', 'A001A', 1),
(30, 'ЛП-000008', '3456789012', '345678003', 'K001A', 3);

-- =====================================================
-- ОБНОВЛЕНИЕ ОСТАТКОВ В ПАРТИЯХ (для демонстрации)
-- =====================================================
UPDATE "Партии" SET "Остаток" = "Остаток" - 
    (SELECT COALESCE(SUM("КоличествоПродано"), 0) 
     FROM "ПозицииЧека" 
     WHERE ("РегНомерЛС", "ИНН", "КПП", "НомерСерии") = ("Партии"."РегНомерЛС", "Партии"."ИНН", "Партии"."КПП", "Партии"."НомерСерии"));
